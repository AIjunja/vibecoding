<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ìœ ì¹˜ì›/ì–´ë¦°ì´ì§‘ AI ì»¤ë¦¬í˜ëŸ¼ & ìŠ¬ë¼ì´ë“œ ë©”ì´ì»¤</title>
  <meta name="description" content="ì—°ë ¹/ì£¼ì œ/ê¸°ê°„ì„ ì„ íƒí•˜ë©´ ìœ ì¹˜ì›Â·ì–´ë¦°ì´ì§‘ ìˆ˜ì—… ì»¤ë¦¬í˜ëŸ¼ê³¼ ìˆ˜ì—…ìš© ìŠ¬ë¼ì´ë“œ ì´ˆì•ˆì„ ìë™ìœ¼ë¡œ ìƒì„±í•©ë‹ˆë‹¤." />
  <meta name="google-adsense-account" content="ca-pub-4845595532179393" />
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4845595532179393" crossorigin="anonymous"></script>
  <style>
    :root{
      --bg:#0c1324;
      --bg2:#111a30;
      --card:rgba(255,255,255,.08);
      --stroke:rgba(255,255,255,.16);
      --text:rgba(255,255,255,.95);
      --muted:rgba(255,255,255,.72);
      --muted2:rgba(255,255,255,.56);
      --accent:#2dd4bf;
      --accent2:#60a5fa;
      --danger:#f87171;
      --ok:#34d399;
      --radius:18px;
      --shadow:0 20px 60px rgba(0,0,0,.45);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      min-height:100vh;
      font-family: ui-sans-serif, system-ui, -apple-system, "Apple SD Gothic Neo","Noto Sans KR", Segoe UI, Roboto, sans-serif;
      color:var(--text);
      background:
        radial-gradient(900px 560px at 15% 8%, rgba(45,212,191,.25), transparent 60%),
        radial-gradient(760px 460px at 86% 18%, rgba(96,165,250,.22), transparent 62%),
        linear-gradient(145deg, var(--bg), var(--bg2));
      padding:24px 12px 56px;
    }
    body[data-theme="light"]{
      --bg:#f3f7ff;
      --bg2:#eef4fc;
      --card:rgba(255,255,255,.86);
      --stroke:rgba(15,23,42,.15);
      --text:rgba(15,23,42,.95);
      --muted:rgba(30,41,59,.78);
      --muted2:rgba(30,41,59,.62);
      --shadow:0 16px 42px rgba(15,23,42,.12);
      background:
        radial-gradient(900px 560px at 15% 8%, rgba(45,212,191,.16), transparent 60%),
        radial-gradient(760px 460px at 86% 18%, rgba(96,165,250,.14), transparent 62%),
        linear-gradient(145deg, var(--bg), var(--bg2));
    }
    .wrap{width:min(1120px,94vw);margin:0 auto;display:grid;gap:14px}
    .top{display:flex;justify-content:space-between;align-items:flex-end;gap:10px;flex-wrap:wrap}
    h1{margin:0;font-size:clamp(22px,3.3vw,38px);letter-spacing:-.03em}
    .sub{margin:6px 0 0;color:var(--muted);font-size:14px;line-height:1.6}
    .pill{display:inline-flex;gap:8px;align-items:center;padding:10px 14px;border:1px solid var(--stroke);border-radius:999px;background:rgba(255,255,255,.05);font-size:12px;color:var(--muted)}
    .themeBtn{border:1px solid var(--stroke);background:rgba(255,255,255,.08);color:var(--text);padding:10px 14px;border-radius:999px;cursor:pointer;font-size:12px;font-weight:700}

    .grid{display:grid;grid-template-columns:1fr 1.25fr;gap:14px;align-items:start}
    @media (max-width:980px){.grid{grid-template-columns:1fr}}

    .card{border:1px solid var(--stroke);background:var(--card);backdrop-filter:blur(10px);border-radius:var(--radius);box-shadow:var(--shadow);overflow:hidden}
    .hd{padding:16px 18px 12px;border-bottom:1px solid var(--stroke)}
    .bd{padding:16px 18px 18px}

    label{display:block;font-size:12px;color:var(--muted2);margin-bottom:6px}
    input,select,textarea{
      width:100%;border:1px solid var(--stroke);border-radius:12px;
      background:rgba(0,0,0,.14);color:var(--text);padding:11px 12px;font-size:14px;outline:none;
    }
    body[data-theme="light"] input,
    body[data-theme="light"] select,
    body[data-theme="light"] textarea{background:rgba(255,255,255,.9)}
    textarea{min-height:76px;resize:vertical;line-height:1.55}

    .row2{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    .row3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px}
    @media (max-width:720px){.row2,.row3{grid-template-columns:1fr}}

    .checkRow{display:flex;gap:14px;flex-wrap:wrap;padding-top:4px}
    .checkRow label{display:flex;align-items:center;gap:7px;margin:0;color:var(--muted);font-size:13px}
    .checkRow input{width:auto}

    .btnRow{display:flex;flex-wrap:wrap;gap:10px;margin-top:12px}
    button{
      border:1px solid var(--stroke);background:rgba(255,255,255,.08);color:var(--text);
      border-radius:12px;padding:11px 14px;font-weight:800;font-size:14px;cursor:pointer
    }
    button.primary{border:none;color:#042028;background:linear-gradient(135deg,var(--accent),var(--accent2))}
    button:disabled{opacity:.55;cursor:not-allowed}

    .tags{display:flex;flex-wrap:wrap;gap:8px;margin:0 0 10px}
    .tag{padding:6px 10px;border:1px solid var(--stroke);border-radius:999px;color:var(--muted);font-size:12px;background:rgba(255,255,255,.05)}

    .dayCard{border:1px solid var(--stroke);border-radius:14px;background:rgba(0,0,0,.14);padding:12px;display:grid;gap:10px;margin-top:10px}
    body[data-theme="light"] .dayCard{background:rgba(255,255,255,.75)}
    .dayTitle{display:flex;justify-content:space-between;align-items:center;gap:10px;flex-wrap:wrap}
    .dayTitle b{font-size:15px}
    .tiny{font-size:12px;color:var(--muted2)}
    .box{border:1px solid var(--stroke);border-radius:12px;padding:10px;background:rgba(255,255,255,.04)}
    .box h4{margin:0 0 6px;font-size:13px}
    .box p,.box li{margin:0;color:var(--muted);font-size:13px;line-height:1.58}
    .box ul{margin:0;padding-left:18px}

    .slideCard{border:1px solid var(--stroke);border-radius:14px;background:rgba(0,0,0,.14);padding:12px;display:grid;gap:8px;margin-top:10px}
    .slideCard h4{margin:0;font-size:14px}

    .warn{margin-top:10px;padding:10px 12px;border:1px dashed var(--stroke);border-radius:12px;color:var(--muted);font-size:12px;background:rgba(0,0,0,.12)}
    .ok{color:var(--ok)} .danger{color:var(--danger)}

    .siteFooter{width:min(1120px,94vw);margin:12px auto 0;border-top:1px solid var(--stroke);padding-top:10px;display:grid;gap:7px;font-size:12px;color:var(--muted2)}
    .links{display:flex;flex-wrap:wrap;gap:10px}
    .links a{color:var(--muted);text-underline-offset:3px}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="top">
      <div>
        <h1>ìœ ì•„êµì‚¬ AI ì»¤ë¦¬í˜ëŸ¼ Â· ìˆ˜ì—…ì•ˆ Â· ìŠ¬ë¼ì´ë“œ ì´ˆì•ˆ ìƒì„±ê¸°</h1>
        <p class="sub">ì—°ë ¹/ì£¼ì œ/ê¸°ê°„ì„ ì„ íƒí•˜ë©´ <b>ì£¼ê°„ ì»¤ë¦¬í˜ëŸ¼ + í™œë™ë³„ ìˆ˜ì—…ì•ˆ + ë°œí‘œìš© ìŠ¬ë¼ì´ë“œ ì´ˆì•ˆ</b>ê¹Œì§€ í•œ ë²ˆì— ìƒì„±í•©ë‹ˆë‹¤.</p>
      </div>
      <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
        <div class="pill">ğŸ‘¶ ìœ ì¹˜ì›/ì–´ë¦°ì´ì§‘ íŠ¹í™” Â· êµì‚¬ìš© ì‹¤ë¬´í˜•</div>
        <button class="themeBtn" id="themeToggle" type="button">ğŸŒ™ ë‹¤í¬ëª¨ë“œ</button>
      </div>
    </div>

    <div class="grid">
      <section class="card">
        <div class="hd">
          <div class="pill">1) í„±í„±í„± ì„ íƒ ì…ë ¥</div>
          <p class="sub" style="margin-top:8px;">ìµœì†Œ í•­ëª©ë§Œ ê³ ë¥´ë©´ ìë™ìœ¼ë¡œ ì£¼ê°„ ê³„íšê³¼ í™œë™ì•ˆì„ ìƒì„±í•©ë‹ˆë‹¤.</p>
        </div>
        <div class="bd">
          <div class="row2">
            <div>
              <label for="age">ëŒ€ìƒ ì—°ë ¹</label>
              <select id="age">
                <option>ë§Œ 3ì„¸</option>
                <option>ë§Œ 4ì„¸</option>
                <option selected>ë§Œ 5ì„¸</option>
              </select>
            </div>
            <div>
              <label for="period">ê¸°ê°„</label>
              <select id="period">
                <option value="day">1ì¼</option>
                <option value="week" selected>1ì£¼(5ì¼)</option>
              </select>
            </div>
          </div>

          <div style="margin-top:10px">
            <label for="topic">ìƒí™œ ì£¼ì œ</label>
            <input id="topic" value="ë´„ê³¼ ê³¤ì¶©" placeholder="ì˜ˆ: ê°€ì¡±, êµí†µ, ê³„ì ˆ, ê°ì •, ë™ë¬¼" />
          </div>

          <div class="row3" style="margin-top:10px">
            <div>
              <label for="focusArea">ê°•ì¡° ì˜ì—­</label>
              <select id="focusArea">
                <option>ì–¸ì–´</option>
                <option selected>ë¯¸ìˆ </option>
                <option>ì‹ ì²´</option>
                <option>ê³¼í•™</option>
                <option>ì‚¬íšŒ</option>
                <option>ìŒì•…</option>
                <option>ì—­í• ë†€ì´</option>
              </select>
            </div>
            <div>
              <label for="materialLevel">ì¤€ë¹„ë¬¼ ë‚œì´ë„</label>
              <select id="materialLevel">
                <option selected>ê°„ë‹¨</option>
                <option>ë³´í†µ</option>
                <option>í’ë¶€</option>
              </select>
            </div>
            <div>
              <label for="slideType">ìŠ¬ë¼ì´ë“œ ìœ í˜•</label>
              <select id="slideType">
                <option selected>ë†€ì´í˜•</option>
                <option>ì„¤ëª…í˜•</option>
                <option>ìŠ¤í† ë¦¬í˜•</option>
                <option>í€´ì¦ˆí˜•</option>
              </select>
            </div>
          </div>

          <div style="margin-top:10px">
            <label>ìš´ì˜ í™˜ê²½</label>
            <div class="checkRow">
              <label><input type="checkbox" id="indoor" checked /> ì‹¤ë‚´</label>
              <label><input type="checkbox" id="outdoor" checked /> ì‹¤ì™¸</label>
              <label><input type="checkbox" id="safetyStrict" checked /> ì•ˆì „ ê°•ì¡°</label>
            </div>
          </div>

          <div style="margin-top:10px">
            <label for="constraints">ì œì•½/ê¸°ê´€ ê·œì¹™</label>
            <textarea id="constraints" placeholder="ì˜ˆ: ì•Œë ˆë¥´ê¸° ì‹í’ˆ ì œì™¸, ì‹¤ë‚´ ì¤‘ì‹¬, ì†ŒìŒ í° í™œë™ ì œì™¸">ì•Œë ˆë¥´ê¸° ì‹í’ˆ ê´€ë ¨ í™œë™ ì œì™¸, ì•ˆì „ ìˆ˜ì¹™ ì•ˆë‚´ë¥¼ ë§¤ í™œë™ë§ˆë‹¤ í¬í•¨</textarea>
          </div>

          <div style="margin-top:10px">
            <label>ìƒì„± ê²°ê³¼ë¬¼</label>
            <div class="checkRow">
              <label><input type="checkbox" id="optCurriculum" checked /> ì»¤ë¦¬í˜ëŸ¼</label>
              <label><input type="checkbox" id="optLesson" checked /> ìˆ˜ì—…ì•ˆ</label>
              <label><input type="checkbox" id="optSlides" checked /> ìŠ¬ë¼ì´ë“œ ì´ˆì•ˆ</label>
            </div>
          </div>

          <div class="btnRow">
            <button class="primary" id="genBtn" type="button">âš¡ ìƒì„±í•˜ê¸°</button>
            <button id="copyBtn" type="button" disabled>ğŸ“‹ ì „ì²´ ë³µì‚¬</button>
            <button id="downloadBtn" type="button" disabled>â¬‡ï¸ JSON ë‹¤ìš´ë¡œë“œ</button>
          </div>

          <div class="warn">ê°œì¸ì •ë³´ ë³´í˜¸: ì•„ë™ ì‹¤ëª…/ë¯¼ê°ì •ë³´ëŠ” ì…ë ¥í•˜ì§€ ë§ˆì„¸ìš”. ìƒì„± ê²°ê³¼ëŠ” êµì‚¬ê°€ ìµœì¢… ê²€í†  í›„ ì‚¬ìš©í•˜ì„¸ìš”.</div>
        </div>
      </section>

      <section class="card">
        <div class="hd">
          <div class="pill">2) ìƒì„± ê²°ê³¼</div>
          <p class="sub" style="margin-top:8px;">ì£¼ê°„/ì¼ì¼ ê³„íšê³¼ í™œë™ë³„ ì§€ë„ì•ˆ, ìŠ¬ë¼ì´ë“œ ì´ˆì•ˆì„ ì¹´ë“œ í˜•íƒœë¡œ í™•ì¸í•©ë‹ˆë‹¤.</p>
        </div>
        <div class="bd">
          <div class="tags" id="metaTags"></div>
          <h2 style="margin:0;font-size:18px" id="outTitle">ì•„ì§ ìƒì„±ëœ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤</h2>
          <p class="sub" id="outDesc">ì™¼ìª½ì—ì„œ ì„ íƒ í›„ ìƒì„± ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.</p>

          <div style="margin-top:10px">
            <label for="slideTargetDay">ìŠ¬ë¼ì´ë“œ ì´ˆì•ˆ ëŒ€ìƒ ì¼ì°¨</label>
            <select id="slideTargetDay" disabled></select>
            <div class="btnRow" style="margin-top:8px">
              <button id="makeSlidesBtn" type="button" disabled>ğŸ§© ì„ íƒ ì¼ì°¨ ìŠ¬ë¼ì´ë“œ ì´ˆì•ˆ ë§Œë“¤ê¸°</button>
            </div>
          </div>

          <div id="curriculumOut"></div>
          <div id="slidesOut"></div>
        </div>
      </section>
    </div>

    <section class="card">
      <div class="hd">
        <div class="pill">ğŸ¤ ì œíœ´/ë„ì… ë¬¸ì˜</div>
        <p class="sub" style="margin-top:8px;">ê¸°ê´€ ë„ì…, ì»¤ìŠ¤í„°ë§ˆì´ì§•, API ì—°ë™ ë¬¸ì˜ë¥¼ ë‚¨ê²¨ì£¼ì„¸ìš”.</p>
      </div>
      <div class="bd">
        <form id="partnershipForm" action="https://formspree.io/f/mdaldrva" method="POST">
          <div class="row2">
            <div>
              <label for="partnerName">ì´ë¦„</label>
              <input id="partnerName" name="name" type="text" required />
            </div>
            <div>
              <label for="partnerEmail">ì´ë©”ì¼</label>
              <input id="partnerEmail" name="email" type="email" required />
            </div>
          </div>
          <div style="margin-top:10px">
            <label for="partnerMessage">ë¬¸ì˜ ë‚´ìš©</label>
            <textarea id="partnerMessage" name="message" required></textarea>
          </div>
          <input type="hidden" name="_subject" value="ìœ ì•„êµì‚¬ AI ì„œë¹„ìŠ¤ ì œíœ´ ë¬¸ì˜" />
          <div class="btnRow">
            <button class="primary" id="partnerSubmitBtn" type="submit">ğŸ“¨ ë¬¸ì˜ ë³´ë‚´ê¸°</button>
          </div>
          <p id="partnerFormStatus" class="sub" style="margin-top:8px"></p>
        </form>
      </div>
    </section>
  </div>

  <footer class="siteFooter">
    <div class="links">
      <a href="/about.html">ì‚¬ì´íŠ¸ ì†Œê°œ</a>
      <a href="/privacy.html">ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨</a>
      <a href="/terms.html">ì´ìš©ì•½ê´€</a>
      <a href="/contact.html">ë¬¸ì˜í•˜ê¸°</a>
      <a href="/ads.txt">ads.txt</a>
    </div>
    <div>ìš´ì˜ ì›ì¹™: ì•„ë™ ëŒ€ìƒ ì•ˆì „Â·í‘œí˜„ ê°€ë“œë ˆì¼, êµì‚¬ ê²€í†  ê¸°ë°˜ í™œìš©, ê´‘ê³ ë³´ë‹¤ êµìœ¡ ì½˜í…ì¸  ìš°ì„ </div>
  </footer>

  <script>
    const $ = (id) => document.getElementById(id);
    const THEME_KEY = "curriculum_theme";

    const areaBank = {
      "ì–¸ì–´":["ê·¸ë¦¼ì±… í•¨ê»˜ ì½ê¸°","ì£¼ì œ ë‹¨ì–´ ì¹´ë“œ ë†€ì´","ì´ì•¼ê¸° ìˆœì„œ ë§ì¶”ê¸°"],
      "ë¯¸ìˆ ":["ì£¼ì œ ì½œë¼ì£¼ ë§Œë“¤ê¸°","ìŠ¤íƒ¬í”„/ì°ê¸° í™œë™","ìì—°ë¬¼ ê¾¸ë¯¸ê¸°"],
      "ì‹ ì²´":["ë™ì‘ ë”°ë¼í•˜ê¸°","ê· í˜• ë†€ì´","ì¥ì• ë¬¼ ë¯¸ë‹ˆ ì½”ìŠ¤"],
      "ê³¼í•™":["ê´€ì°° ê¸°ë¡í•˜ê¸°","ë¹„êµ/ë¶„ë¥˜ í™œë™","ê°„ë‹¨ ì‹¤í—˜"],
      "ì‚¬íšŒ":["í˜‘ë™ ê·œì¹™ ë†€ì´","ì—­í•  ë‚˜ëˆ” í™œë™","ê°ì • ë‚˜ëˆ„ê¸°"],
      "ìŒì•…":["ë¦¬ë“¬ ë”°ë¼í•˜ê¸°","ì£¼ì œ ë…¸ë˜ ë°”ê¿”ë¶€ë¥´ê¸°","ì•…ê¸° íƒìƒ‰"],
      "ì—­í• ë†€ì´":["ìƒí™©ê·¹ ë†€ì´","ê°€ê²Œ/ë³‘ì› ì—­í• ë†€ì´","ì¸í˜•ê·¹ êµ¬ì„±"]
    };

    const secondaryAreas = ["ì–¸ì–´","ì‹ ì²´","ê³¼í•™","ì‚¬íšŒ","ìŒì•…","ì—­í• ë†€ì´","ë¯¸ìˆ "];
    const weekDays = ["ì›”ìš”ì¼","í™”ìš”ì¼","ìˆ˜ìš”ì¼","ëª©ìš”ì¼","ê¸ˆìš”ì¼"];
    let current = null;

    function getTheme(){
      const saved = localStorage.getItem(THEME_KEY);
      if (saved === "dark" || saved === "light") return saved;
      return window.matchMedia("(prefers-color-scheme: dark)").matches ? "dark" : "light";
    }

    function applyTheme(theme){
      document.body.dataset.theme = theme;
      localStorage.setItem(THEME_KEY, theme);
      $("themeToggle").textContent = theme === "dark" ? "ğŸŒ™ ë‹¤í¬ëª¨ë“œ" : "â˜€ï¸ í™”ì´íŠ¸ëª¨ë“œ";
    }

    function pick(arr, idx){ return arr[idx % arr.length]; }

    function getForm(){
      return {
        age: $("age").value,
        period: $("period").value,
        topic: $("topic").value.trim() || "ìƒí™œ ì£¼ì œ",
        focusArea: $("focusArea").value,
        materialLevel: $("materialLevel").value,
        slideType: $("slideType").value,
        indoor: $("indoor").checked,
        outdoor: $("outdoor").checked,
        safetyStrict: $("safetyStrict").checked,
        constraints: $("constraints").value.trim(),
        options: {
          curriculum: $("optCurriculum").checked,
          lesson: $("optLesson").checked,
          slides: $("optSlides").checked
        }
      };
    }

    function buildDays(cfg){
      const dayCount = cfg.period === "week" ? 5 : 1;
      const days = [];
      for (let i=0; i<dayCount; i++){
        const dayName = cfg.period === "week" ? weekDays[i] : "ì˜¤ëŠ˜";
        const secArea = pick(secondaryAreas.filter(a => a !== cfg.focusArea), i);
        const activityA = pick(areaBank[cfg.focusArea], i);
        const activityB = pick(areaBank[secArea], i+1);

        const lesson = {
          intro: `${cfg.topic}ì™€ ì—°ê²°ëœ ê²½í—˜ì„ ë– ì˜¬ë¦¬ê²Œ í•˜ëŠ” ì§ˆë¬¸ 2~3ê°œë¡œ ë„ì…í•©ë‹ˆë‹¤.`,
          main: `${activityA} ì¤‘ì‹¬ìœ¼ë¡œ ì•„ì´ ì°¸ì—¬ë¥¼ ìœ ë„í•˜ê³ , ì´ì–´ì„œ ${activityB}ë¡œ í™•ì¥í•©ë‹ˆë‹¤.`,
          wrap: "ê´€ì°°í•œ ì ì„ ë§ë¡œ ì •ë¦¬í•˜ê³ , ì˜¤ëŠ˜ í™œë™ì—ì„œ ê°€ì¥ ì¬ë¯¸ìˆì—ˆë˜ ìˆœê°„ì„ ê³µìœ í•©ë‹ˆë‹¤.",
          questions: [
            `${cfg.topic}ì—ì„œ ì˜¤ëŠ˜ ìš°ë¦¬ê°€ ì°¾ì€ ì ì€ ë¬´ì—‡ì¼ê¹Œìš”?`,
            "ì™œ ê·¸ë ‡ê²Œ ìƒê°í–ˆëŠ”ì§€ ì¹œêµ¬ì—ê²Œ ì„¤ëª…í•´ ë³¼ê¹Œìš”?",
            "ë‹¤ìŒ í™œë™ì—ì„œ ë°”ê¿”ë³´ê³  ì‹¶ì€ ì ì€ ë¬´ì—‡ì¼ê¹Œìš”?"
          ],
          safety: cfg.safetyStrict
            ? ["í™œë™ ì‹œì‘ ì „ ì•ˆì „ ê·œì¹™ 3ê°€ì§€ í™•ì¸", "ë„êµ¬ ì‚¬ìš© ì‹œ êµì‚¬ ì‹œë²” í›„ ì§„í–‰", "í™œë™ í›„ ì •ë¦¬ ë° ì† ì”»ê¸°"]
            : ["ê¸°ë³¸ ì•ˆì „ ê·œì¹™ ì•ˆë‚´", "í™œë™ ê³µê°„ ì •ë¦¬"]
        };

        days.push({
          dayName,
          goal: `${cfg.age} ì•„ë™ì´ ${cfg.topic}ë¥¼ ${cfg.focusArea} ì¤‘ì‹¬ í™œë™ìœ¼ë¡œ ì´í•´í•˜ê³  í‘œí˜„í•œë‹¤.`,
          areas: [cfg.focusArea, secArea],
          activities: [activityA, activityB],
          materials: cfg.materialLevel === "ê°„ë‹¨"
            ? ["ìƒ‰ì—°í•„", "A4 ìš©ì§€", "ìŠ¤í‹°ì»¤"]
            : cfg.materialLevel === "ë³´í†µ"
              ? ["ìƒ‰ì§€", "í’€", "ê°€ìœ„(êµì‚¬ ê´€ë¦¬)", "í™œë™ ì¹´ë“œ"]
              : ["ìì—°ë¬¼ ì†Œí’ˆ", "í…œí”Œë¦¿ ì¹´ë“œ", "ë³´ì¡° êµêµ¬"],
          environment: `${cfg.indoor ? "ì‹¤ë‚´" : ""}${cfg.indoor && cfg.outdoor ? " + " : ""}${cfg.outdoor ? "ì‹¤ì™¸" : ""}` || "ì‹¤ë‚´",
          lesson
        });
      }
      return days;
    }

    function generateSlidesForDay(day, cfg){
      const styleTips = {
        "ë†€ì´í˜•":"ì§§ì€ ë¬¸ì¥ + í° ì•„ì´ì½˜ + í–‰ë™ ì§€ì‹œ",
        "ì„¤ëª…í˜•":"í•µì‹¬ ê°œë… ì¤‘ì‹¬ì˜ ë‹¨ê³„í˜• ì„¤ëª…",
        "ìŠ¤í† ë¦¬í˜•":"ìƒí™©-ë¬¸ì œ-í•´ê²° íë¦„ì˜ ë‚´ëŸ¬í‹°ë¸Œ",
        "í€´ì¦ˆí˜•":"ì§ˆë¬¸-ì„ íƒ-í”¼ë“œë°± êµ¬ì¡°"
      };

      return [
        {title:`ì˜¤ëŠ˜ì˜ ì£¼ì œ: ${cfg.topic}`, body:`${day.dayName} ìˆ˜ì—… ëª©í‘œ: ${day.goal}`},
        {title:"ë„ì… ì§ˆë¬¸", body:day.lesson.questions[0]},
        {title:`í™œë™ 1: ${day.activities[0]}`, body:`ì¤€ë¹„ë¬¼: ${day.materials.join(", ")} / ì§„í–‰: ${day.lesson.main}`},
        {title:`í™œë™ 2: ${day.activities[1]}`, body:`í™•ì¥ í™œë™ìœ¼ë¡œ ${day.areas[1]} ì˜ì—­ì„ ì—°ê²°í•©ë‹ˆë‹¤.`},
        {title:"ì•ˆì „ ì•½ì†", body:day.lesson.safety.join(" Â· ")},
        {title:"ë§ˆë¬´ë¦¬ ë° ê³µìœ ", body:`ì •ë¦¬ ì§ˆë¬¸: ${day.lesson.questions[2]} / í…œí”Œë¦¿: ${styleTips[cfg.slideType]}`}
      ];
    }

    function renderMeta(cfg, days){
      const tags = [cfg.age, cfg.period === "week" ? "1ì£¼ 5ì¼" : "1ì¼", `ì£¼ì œ: ${cfg.topic}`, `ê°•ì¡°: ${cfg.focusArea}`, `ìŠ¬ë¼ì´ë“œ: ${cfg.slideType}`];
      $("metaTags").innerHTML = tags.map(t => `<span class="tag">${escapeHtml(t)}</span>`).join("");
      $("outTitle").textContent = `${cfg.topic} ì»¤ë¦¬í˜ëŸ¼ ìƒì„± ì™„ë£Œ`;
      $("outDesc").textContent = `${days.length}ê°œ ì¼ì°¨ ê¸°ì¤€ìœ¼ë¡œ ì»¤ë¦¬í˜ëŸ¼ê³¼ ìˆ˜ì—…ì•ˆì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.`;
    }

    function escapeHtml(s){
      return String(s)
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    function renderCurriculum(cur){
      const out = $("curriculumOut");
      out.innerHTML = "";
      if (!cur.config.options.curriculum && !cur.config.options.lesson) {
        out.innerHTML = '<p class="sub">ì»¤ë¦¬í˜ëŸ¼/ìˆ˜ì—…ì•ˆ ì¶œë ¥ ì˜µì…˜ì´ êº¼ì ¸ ìˆìŠµë‹ˆë‹¤.</p>';
        return;
      }

      cur.days.forEach((d, idx) => {
        const div = document.createElement("div");
        div.className = "dayCard";
        div.innerHTML = `
          <div class="dayTitle">
            <b>${escapeHtml(d.dayName)} Â· ${escapeHtml(d.activities[0])}</b>
            <span class="tiny">ì˜ì—­: ${escapeHtml(d.areas.join(" / "))}</span>
          </div>
          <div class="box"><h4>ì¼ì¼ ëª©í‘œ</h4><p>${escapeHtml(d.goal)}</p></div>
          ${cur.config.options.lesson ? `
            <div class="box"><h4>ìˆ˜ì—…ì•ˆ (ë„ì…-ì „ê°œ-ë§ˆë¬´ë¦¬)</h4>
              <ul>
                <li><b>ë„ì…:</b> ${escapeHtml(d.lesson.intro)}</li>
                <li><b>ì „ê°œ:</b> ${escapeHtml(d.lesson.main)}</li>
                <li><b>ë§ˆë¬´ë¦¬:</b> ${escapeHtml(d.lesson.wrap)}</li>
              </ul>
            </div>
            <div class="box"><h4>ë°œë¬¸/ì§ˆë¬¸</h4><ul>${d.lesson.questions.map(q => `<li>${escapeHtml(q)}</li>`).join("")}</ul></div>
            <div class="box"><h4>ì•ˆì „ ìœ ì˜</h4><ul>${d.lesson.safety.map(s => `<li>${escapeHtml(s)}</li>`).join("")}</ul></div>
          ` : ""}
          <div class="tiny">í™˜ê²½: ${escapeHtml(d.environment)} Â· ì¤€ë¹„ë¬¼: ${escapeHtml(d.materials.join(", "))}</div>
        `;
        out.appendChild(div);
      });

      const target = $("slideTargetDay");
      target.disabled = false;
      target.innerHTML = cur.days.map((d,i) => `<option value="${i}">${escapeHtml(d.dayName)} - ${escapeHtml(d.activities[0])}</option>`).join("");
      $("makeSlidesBtn").disabled = !cur.config.options.slides;
    }

    function renderSlides(slides, dayName){
      const out = $("slidesOut");
      out.innerHTML = `<h3 style="margin:16px 0 6px">${escapeHtml(dayName)} ìŠ¬ë¼ì´ë“œ ì´ˆì•ˆ</h3>`;
      slides.forEach((s, idx) => {
        const div = document.createElement("div");
        div.className = "slideCard";
        div.innerHTML = `<h4>${idx+1}. ${escapeHtml(s.title)}</h4><p class="sub" style="margin:0">${escapeHtml(s.body)}</p>`;
        out.appendChild(div);
      });
      out.insertAdjacentHTML("beforeend", '<div class="warn"><span class="ok">TIP</span> ì´ ì´ˆì•ˆì„ PPTX/Google Slides ë Œë”ëŸ¬ APIì— ì „ë‹¬í•˜ë©´ ìë™ ì¥í‘œ ìƒì„± íŒŒì´í”„ë¼ì¸ìœ¼ë¡œ í™•ì¥í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</div>');
    }

    function buildPlainText(cur){
      let t = `# ${cur.config.topic} ì»¤ë¦¬í˜ëŸ¼\n`;
      t += `- ëŒ€ìƒ: ${cur.config.age}\n`;
      t += `- ê¸°ê°„: ${cur.config.period === "week" ? "1ì£¼(5ì¼)" : "1ì¼"}\n`;
      t += `- ê°•ì¡° ì˜ì—­: ${cur.config.focusArea}\n`;
      t += `- ì œì•½: ${cur.config.constraints || "-"}\n\n`;
      cur.days.forEach(d => {
        t += `## ${d.dayName}\n`;
        t += `- ëª©í‘œ: ${d.goal}\n`;
        t += `- í™œë™: ${d.activities.join(", ")}\n`;
        t += `- ë„ì…: ${d.lesson.intro}\n`;
        t += `- ì „ê°œ: ${d.lesson.main}\n`;
        t += `- ë§ˆë¬´ë¦¬: ${d.lesson.wrap}\n`;
        t += `- ì•ˆì „: ${d.lesson.safety.join(" / ")}\n\n`;
      });
      return t;
    }

    function enableOutputButtons(ok){
      $("copyBtn").disabled = !ok;
      $("downloadBtn").disabled = !ok;
    }

    $("genBtn").addEventListener("click", () => {
      const cfg = getForm();
      if (!cfg.indoor && !cfg.outdoor){
        alert("ìš´ì˜ í™˜ê²½(ì‹¤ë‚´/ì‹¤ì™¸) ì¤‘ ìµœì†Œ 1ê°œë¥¼ ì„ íƒí•´ ì£¼ì„¸ìš”.");
        return;
      }
      if (!cfg.options.curriculum && !cfg.options.lesson && !cfg.options.slides){
        alert("ìµœì†Œ 1ê°œ ê²°ê³¼ë¬¼ ì˜µì…˜ì„ ì„ íƒí•´ ì£¼ì„¸ìš”.");
        return;
      }

      const days = buildDays(cfg);
      current = { config: cfg, days, createdAt: new Date().toISOString() };
      renderMeta(cfg, days);
      renderCurriculum(current);
      $("slidesOut").innerHTML = "";
      enableOutputButtons(true);
    });

    $("makeSlidesBtn").addEventListener("click", () => {
      if (!current) return;
      const idx = Number($("slideTargetDay").value || 0);
      const day = current.days[idx];
      const slides = generateSlidesForDay(day, current.config);
      current.lastSlides = { dayIndex: idx, slides };
      renderSlides(slides, day.dayName);
    });

    $("copyBtn").addEventListener("click", async () => {
      if (!current) return;
      const txt = buildPlainText(current);
      try{
        await navigator.clipboard.writeText(txt);
        const prev = $("copyBtn").textContent;
        $("copyBtn").textContent = "ë³µì‚¬ ì™„ë£Œ âœ…";
        setTimeout(() => { $("copyBtn").textContent = prev; }, 1000);
      }catch(_e){
        alert("ë³µì‚¬ ê¶Œí•œì´ ì—†ì–´ í…ìŠ¤íŠ¸ë¥¼ ë³µì‚¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
      }
    });

    $("downloadBtn").addEventListener("click", () => {
      if (!current) return;
      const blob = new Blob([JSON.stringify(current, null, 2)], {type:"application/json"});
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = `kindergarten_curriculum_${Date.now()}.json`;
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
    });

    $("themeToggle").addEventListener("click", () => {
      const next = document.body.dataset.theme === "dark" ? "light" : "dark";
      applyTheme(next);
    });

    const partnershipForm = $("partnershipForm");
    const partnerSubmitBtn = $("partnerSubmitBtn");
    const partnerFormStatus = $("partnerFormStatus");

    partnershipForm.addEventListener("submit", async (e) => {
      e.preventDefault();
      partnerSubmitBtn.disabled = true;
      partnerFormStatus.textContent = "ë¬¸ì˜ ì „ì†¡ ì¤‘...";
      partnerFormStatus.className = "sub";
      try{
        const res = await fetch(partnershipForm.action, {
          method:"POST",
          body:new FormData(partnershipForm),
          headers:{"Accept":"application/json"}
        });
        if (!res.ok) throw new Error("fail");
        partnershipForm.reset();
        partnerFormStatus.textContent = "ë¬¸ì˜ê°€ ì ‘ìˆ˜ë˜ì—ˆìŠµë‹ˆë‹¤.";
        partnerFormStatus.className = "sub ok";
      }catch(_err){
        partnerFormStatus.textContent = "ì „ì†¡ ì‹¤íŒ¨: ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.";
        partnerFormStatus.className = "sub danger";
      }finally{
        partnerSubmitBtn.disabled = false;
      }
    });

    applyTheme(getTheme());
    enableOutputButtons(false);
  </script>
</body>
</html>
